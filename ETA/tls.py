#!/usr/bin/env python
# -*- coding:utf-8 -*-

cs = {u'c005': 0, u'c004': 1, u'c007': 2, u'0039': 3, u'0038': 4, u'c003': 5, u'c002': 6, u'0035': 7,
           u'0034': 8, u'0037': 9, u'0036': 10, u'c009': 11, u'c008': 12, u'0033': 13, u'0032': 14, u'c07a': 15,
           u'c07b': 16, u'c07c': 17, u'c07d': 18, u'0065': 19, u'c087': 21, u'c086': 22, u'c081': 23,
           u'c080': 24,
           u'c072': 25, u'c073': 26, u'c076': 27, u'c077': 28, u'0040': 29, u'0041': 30, u'0042': 31,
           u'feff': 32,
           u'0044': 33, u'0045': 34, u'0046': 35, u'0030': 36, u'c00e': 37, u'c00d': 38, u'c00f': 39,
           u'c00a': 40,
           u'c00c': 41, u'003e': 42, u'003d': 43, u'003f': 44, u'003a': 45, u'003c': 46, u'003b': 47,
           u'006a': 109,
           u'00ff': 49, u'00fd': 50, u'00fb': 51, u'00fc': 52, u'c08a': 53, u'c08b': 54, u'5600': 55,
           u'c05d': 56,
           u'c05c': 57, u'00af': 58, u'00ae': 59, u'0017': 113, u'00a7': 60, u'00a6': 61, u'00a5': 62,
           u'00a4': 63,
           u'00a3': 64, u'00a2': 65, u'00a1': 66, u'00a0': 67, u'cc13': 68, u'cc15': 69, u'cc14': 70,
           u'c049': 71,
           u'c048': 20, u'0016': 114, u'000d': 74, u'000f': 75, u'000a': 76, u'000c': 77, u'0064': 81,
           u'0066': 79,
           u'0067': 80, u'00b0': 78, u'00b1': 82, u'0062': 83, u'0063': 84, u'0060': 85, u'0061': 86,
           u'0068': 87,
           u'0069': 88, u'0004': 89, u'0005': 90, u'0006': 91, u'0007': 92, u'0001': 93, u'0002': 94,
           u'0003': 95,
           u'0008': 96, u'0009': 97, u'0031': 98, u'0019': 125, u'0018': 126, u'c030': 101, u'c031': 102,
           u'c032': 103, u'006d': 104, u'00ba': 105, u'006b': 106, u'006c': 107, u'00bd': 108, u'00be': 48,
           u'00c4': 110, u'00c0': 111, u'00c3': 112, u'cca9': 72, u'cca8': 73, u'0015': 115, u'0014': 116,
           u'0013': 117, u'0012': 118, u'0011': 119, u'0010': 120, u'c01b': 121, u'c01c': 122, u'c01a': 123,
           u'c01f': 124, u'c01d': 99, u'c01e': 100, u'002c': 127, u'002f': 128, u'c029': 129, u'c028': 130,
           u'c027': 131, u'c026': 132, u'c025': 133, u'c024': 134, u'c023': 135, u'c022': 136, u'c021': 137,
           u'c020': 138, u'009f': 139, u'009e': 140, u'009d': 141, u'009c': 142, u'009b': 143, u'009a': 144,
           u'0088': 145, u'0089': 146, u'0084': 147, u'0085': 148, u'0086': 149, u'0087': 150, u'0043': 151,
           u'c02f': 152, u'c02e': 153, u'c02d': 154, u'c02c': 155, u'c02b': 156, u'c02a': 157, u'c018': 158,
           u'c019': 159, u'001b': 160, u'001a': 161, u'c012': 162, u'c013': 163, u'c011': 164, u'c016': 165,
           u'c017': 166, u'c014': 167, u'008d': 168, u'008a': 169, u'008b': 170, u'008c': 171, u'0099': 172,
           u'0098': 173, u'0097': 174, u'0096': 175}
# 21
ext = {u'server_name': 0, u'extended_master_secret': 1, u'renegotiation_info': 2, u'supported_groups': 3,
            u'ec_point_formats': 4, u'session_ticket': 5, u'application_layer_protocol_negotiation': 6,
            u'status_request': 7, u'signature_algorithms': 8}

class Tls(object):
    def __init__(self, info):
        self.version_code_map = {
        "SSLv2": 1,
        "SSLv3": 2,
        "TLSv10": 3,
        "TLSv11": 4,
        "TLSv12": 5
        }
        self.cipher_bytes_map = {
            "TLS_NULL_WITH_NULL_NULL": "0000",
            "TLS_RSA_WITH_NULL_MD5": "0001",
            "TLS_RSA_WITH_NULL_SHA": "0002",
            "TLS_RSA_EXPORT_WITH_RC4_40_MD5": "0003",
            "TLS_RSA_WITH_RC4_128_MD5": "0004",
            "TLS_RSA_WITH_RC4_128_SHA": "0005",
            "TLS_RSA_EXPORT_WITH_RC2_CBC_40_MD5": "0006",
            "TLS_RSA_WITH_IDEA_CBC_SHA": "0007",
            "TLS_RSA_EXPORT_WITH_DES40_CBC_SHA": "0008",
            "TLS_RSA_WITH_DES_CBC_SHA": "0009",
            "TLS_RSA_WITH_3DES_EDE_CBC_SHA": "000A",
            "TLS_DH_DSS_EXPORT_WITH_DES40_CBC_SHA": "000B",
            "TLS_DH_DSS_WITH_DES_CBC_SHA": "000C",
            "TLS_DH_DSS_WITH_3DES_EDE_CBC_SHA": "000D",
            "TLS_DH_RSA_EXPORT_WITH_DES40_CBC_SHA": "000E",
            "TLS_DH_RSA_WITH_DES_CBC_SHA": "000F",
            "TLS_DH_RSA_WITH_3DES_EDE_CBC_SHA": "0010",
            "TLS_DHE_DSS_EXPORT_WITH_DES40_CBC_SHA": "0011",
            "TLS_DHE_DSS_WITH_DES_CBC_SHA": "0012",
            "TLS_DHE_DSS_WITH_3DES_EDE_CBC_SHA": "0013",
            "TLS_DHE_RSA_EXPORT_WITH_DES40_CBC_SHA": "0014",
            "TLS_DHE_RSA_WITH_DES_CBC_SHA": "0015",
            "TLS_DHE_RSA_WITH_3DES_EDE_CBC_SHA": "0016",
            "TLS_DH_ANON_EXPORT_WITH_RC4_40_MD5": "0017",
            "TLS_DH_ANON_WITH_RC4_128_MD5": "0018",
            "TLS_DH_ANON_EXPORT_WITH_DES40_CBC_SHA": "0019",
            "TLS_DH_ANON_WITH_DES_CBC_SHA": "001A",
            "TLS_DH_ANON_WITH_3DES_EDE_CBC_SHA": "001B",
            "SSL_FORTEZZA_KEA_WITH_NULL_SHA": "001C",
            "SSL_FORTEZZA_KEA_WITH_FORTEZZA_CBC_SHA": "001D",
            "TLS_KRB5_WITH_DES_CBC_SHA": "001E",
            "TLS_KRB5_WITH_3DES_EDE_CBC_SHA": "001F",
            "TLS_KRB5_WITH_RC4_128_SHA": "0020",
            "TLS_KRB5_WITH_IDEA_CBC_SHA": "0021",
            "TLS_KRB5_WITH_DES_CBC_MD5": "0022",
            "TLS_KRB5_WITH_3DES_EDE_CBC_MD5": "0023",
            "TLS_KRB5_WITH_RC4_128_MD5": "0024",
            "TLS_KRB5_WITH_IDEA_CBC_MD5": "0025",
            "TLS_KRB5_EXPORT_WITH_DES_CBC_40_SHA": "0026",
            "TLS_KRB5_EXPORT_WITH_RC2_CBC_40_SHA": "0027",
            "TLS_KRB5_EXPORT_WITH_RC4_40_SHA": "0028",
            "TLS_KRB5_EXPORT_WITH_DES_CBC_40_MD5": "0029",
            "TLS_KRB5_EXPORT_WITH_RC2_CBC_40_MD5": "002A",
            "TLS_KRB5_EXPORT_WITH_RC4_40_MD5": "002B",
            "TLS_RSA_WITH_AES_128_CBC_SHA": "002F",
            "TLS_DH_DSS_WITH_AES_128_CBC_SHA": "0030",
            "TLS_DH_RSA_WITH_AES_128_CBC_SHA": "0031",
            "TLS_DHE_DSS_WITH_AES_128_CBC_SHA": "0032",
            "TLS_DHE_RSA_WITH_AES_128_CBC_SHA": "0033",
            "TLS_DH_ANON_WITH_AES_128_CBC_SHA": "0034",
            "TLS_RSA_WITH_AES_256_CBC_SHA": "0035",
            "TLS_DH_DSS_WITH_AES_256_CBC_SHA": "0036",
            "TLS_DH_RSA_WITH_AES_256_CBC_SHA": "0037",
            "TLS_DHE_DSS_WITH_AES_256_CBC_SHA": "0038",
            "TLS_DHE_RSA_WITH_AES_256_CBC_SHA": "0039",
            "TLS_DH_ANON_WITH_AES_256_CBC_SHA": "003A",
            "TLS_RSA_WITH_NULL_SHA256": "003B",
            "TLS_RSA_WITH_AES_128_CBC_SHA256": "003C",
            "TLS_RSA_WITH_AES_256_CBC_SHA256": "003D",
            "TLS_DH_DSS_WITH_AES_128_CBC_SHA256": "003E",
            "TLS_DH_RSA_WITH_AES_128_CBC_SHA256": "003F",
            "TLS_DHE_DSS_WITH_AES_128_CBC_SHA256": "0040",
            "TLS_RSA_WITH_CAMELLIA_128_CBC_SHA": "0041",
            "TLS_DH_DSS_WITH_CAMELLIA_128_CBC_SHA": "0042",
            "TLS_DH_RSA_WITH_CAMELLIA_128_CBC_SHA": "0043",
            "TLS_DHE_DSS_WITH_CAMELLIA_128_CBC_SHA": "0044",
            "TLS_DHE_RSA_WITH_CAMELLIA_128_CBC_SHA": "0045",
            "TLS_DH_ANON_WITH_CAMELLIA_128_CBC_SHA": "0046",
            "TLS_RSA_EXPORT1024_WITH_RC4_56_MD5": "0060",
            "TLS_RSA_EXPORT1024_WITH_RC2_CBC_56_MD5": "0061",
            "TLS_RSA_EXPORT1024_WITH_DES_CBC_SHA": "0062",
            "TLS_DHE_DSS_EXPORT1024_WITH_DES_CBC_SHA": "0063",
            "TLS_RSA_EXPORT1024_WITH_RC4_56_SHA": "0064",
            "TLS_DHE_DSS_EXPORT1024_WITH_RC4_56_SHA": "0065",
            "TLS_DHE_DSS_WITH_RC4_128_SHA": "0066",
            "TLS_DHE_RSA_WITH_AES_128_CBC_SHA256": "0067",
            "TLS_DH_DSS_WITH_AES_256_CBC_SHA256": "0068",
            "TLS_DH_RSA_WITH_AES_256_CBC_SHA256": "0069",
            "TLS_DHE_DSS_WITH_AES_256_CBC_SHA256": "006A",
            "TLS_DHE_RSA_WITH_AES_256_CBC_SHA256": "006B",
            "TLS_DH_ANON_WITH_AES_128_CBC_SHA256": "006C",
            "TLS_DH_ANON_WITH_AES_256_CBC_SHA256": "006D",
            "TLS_DHE_DSS_WITH_3DES_EDE_CBC_RMD": "0072",
            "TLS_DHE_DSS_WITH_AES_128_CBC_RMD": "0073",
            "TLS_DHE_DSS_WITH_AES_256_CBC_RMD": "0074",
            "TLS_DHE_RSA_WITH_3DES_EDE_CBC_RMD": "0077",
            "TLS_DHE_RSA_WITH_AES_128_CBC_RMD": "0078",
            "TLS_DHE_RSA_WITH_AES_256_CBC_RMD": "0079",
            "TLS_RSA_WITH_3DES_EDE_CBC_RMD": "007C",
            "TLS_RSA_WITH_AES_128_CBC_RMD": "007D",
            "TLS_RSA_WITH_AES_256_CBC_RMD": "007E",
            "TLS_GOSTR341094_WITH_28147_CNT_IMIT": "0080",
            "TLS_GOSTR341001_WITH_28147_CNT_IMIT": "0081",
            "TLS_GOSTR341094_WITH_NULL_GOSTR3411": "0082",
            "TLS_GOSTR341001_WITH_NULL_GOSTR3411": "0083",
            "TLS_RSA_WITH_CAMELLIA_256_CBC_SHA": "0084",
            "TLS_DH_DSS_WITH_CAMELLIA_256_CBC_SHA": "0085",
            "TLS_DH_RSA_WITH_CAMELLIA_256_CBC_SHA": "0086",
            "TLS_DHE_DSS_WITH_CAMELLIA_256_CBC_SHA": "0087",
            "TLS_DHE_RSA_WITH_CAMELLIA_256_CBC_SHA": "0088",
            "TLS_DH_ANON_WITH_CAMELLIA_256_CBC_SHA": "0089",
            "TLS_PSK_WITH_RC4_128_SHA": "008A",
            "TLS_PSK_WITH_3DES_EDE_CBC_SHA": "008B",
            "TLS_PSK_WITH_AES_128_CBC_SHA": "008C",
            "TLS_PSK_WITH_AES_256_CBC_SHA": "008D",
            "TLS_DHE_PSK_WITH_RC4_128_SHA": "008E",
            "TLS_DHE_PSK_WITH_3DES_EDE_CBC_SHA": "008F",
            "TLS_DHE_PSK_WITH_AES_128_CBC_SHA": "0090",
            "TLS_DHE_PSK_WITH_AES_256_CBC_SHA": "0091",
            "TLS_RSA_PSK_WITH_RC4_128_SHA": "0092",
            "TLS_RSA_PSK_WITH_3DES_EDE_CBC_SHA": "0093",
            "TLS_RSA_PSK_WITH_AES_128_CBC_SHA": "0094",
            "TLS_RSA_PSK_WITH_AES_256_CBC_SHA": "0095",
            "TLS_RSA_WITH_SEED_CBC_SHA": "0096",
            "TLS_DH_DSS_WITH_SEED_CBC_SHA": "0097",
            "TLS_DH_RSA_WITH_SEED_CBC_SHA": "0098",
            "TLS_DHE_DSS_WITH_SEED_CBC_SHA": "0099",
            "TLS_DHE_RSA_WITH_SEED_CBC_SHA": "009A",
            "TLS_DH_ANON_WITH_SEED_CBC_SHA": "009B",
            "TLS_RSA_WITH_AES_128_GCM_SHA256": "009C",
            "TLS_RSA_WITH_AES_256_GCM_SHA384": "009D",
            "TLS_DHE_RSA_WITH_AES_128_GCM_SHA256": "009E",
            "TLS_DHE_RSA_WITH_AES_256_GCM_SHA384": "009F",
            "TLS_DH_RSA_WITH_AES_128_GCM_SHA256": "00A0",
            "TLS_DH_RSA_WITH_AES_256_GCM_SHA384": "00A1",
            "TLS_DHE_DSS_WITH_AES_128_GCM_SHA256": "00A2",
            "TLS_DHE_DSS_WITH_AES_256_GCM_SHA384": "00A3",
            "TLS_DH_DSS_WITH_AES_128_GCM_SHA256": "00A4",
            "TLS_DH_DSS_WITH_AES_256_GCM_SHA384": "00A5",
            "TLS_DH_ANON_WITH_AES_128_GCM_SHA256": "00A6",
            "TLS_DH_ANON_WITH_AES_256_GCM_SHA384": "00A7",
            "TLS_PSK_WITH_AES_128_GCM_SHA256": "00A8",
            "TLS_PSK_WITH_AES_256_GCM_SHA384": "00A9",
            "TLS_DHE_PSK_WITH_AES_128_GCM_SHA256": "00AA",
            "TLS_DHE_PSK_WITH_AES_256_GCM_SHA384": "00AB",
            "TLS_RSA_PSK_WITH_AES_128_GCM_SHA256": "00AC",
            "TLS_RSA_PSK_WITH_AES_256_GCM_SHA384": "00AD",
            "TLS_PSK_WITH_AES_128_CBC_SHA256": "00AE",
            "TLS_PSK_WITH_AES_256_CBC_SHA384": "00AF",
            "TLS_PSK_WITH_NULL_SHA256": "00B0",
            "TLS_PSK_WITH_NULL_SHA384": "00B1",
            "TLS_DHE_PSK_WITH_AES_128_CBC_SHA256": "00B2",
            "TLS_DHE_PSK_WITH_AES_256_CBC_SHA384": "00B3",
            "TLS_DHE_PSK_WITH_NULL_SHA256": "00B4",
            "TLS_DHE_PSK_WITH_NULL_SHA384": "00B5",
            "TLS_RSA_PSK_WITH_AES_128_CBC_SHA256": "00B6",
            "TLS_RSA_PSK_WITH_AES_256_CBC_SHA384": "00B7",
            "TLS_RSA_PSK_WITH_NULL_SHA256": "00B8",
            "TLS_RSA_PSK_WITH_NULL_SHA384": "00B9",
            "TLS_RSA_WITH_CAMELLIA_128_CBC_SHA256": "00BA",
            "TLS_DH_DSS_WITH_CAMELLIA_128_CBC_SHA256": "00BB",
            "TLS_DH_RSA_WITH_CAMELLIA_128_CBC_SHA256": "00BC",
            "TLS_DHE_DSS_WITH_CAMELLIA_128_CBC_SHA256": "00BD",
            "TLS_DHE_RSA_WITH_CAMELLIA_128_CBC_SHA256": "00BE",
            "TLS_DH_ANON_WITH_CAMELLIA_128_CBC_SHA256": "00BF",
            "TLS_RSA_WITH_CAMELLIA_256_CBC_SHA256": "00C0",
            "TLS_DH_DSS_WITH_CAMELLIA_256_CBC_SHA256": "00C1",
            "TLS_DH_RSA_WITH_CAMELLIA_256_CBC_SHA256": "00C2",
            "TLS_DHE_DSS_WITH_CAMELLIA_256_CBC_SHA256": "00C3",
            "TLS_DHE_RSA_WITH_CAMELLIA_256_CBC_SHA256": "00C4",
            "TLS_DH_ANON_WITH_CAMELLIA_256_CBC_SHA256": "00C5",
            "TLS_AES_128_GCM_SHA256": "1301",
            "TLS_AES_256_GCM_SHA384": "1302",
            "TLS_CHACHA20_POLY1305_SHA256": "1303",
            "TLS_AES_128_CCM_SHA256": "1304",
            "TLS_AES_128_CCM_8_SHA256": "1305",
            "TLS_FALLBACK_SCSV": "5600",
            "TLS_ECDH_ECDSA_WITH_NULL_SHA": "C001",
            "TLS_ECDH_ECDSA_WITH_RC4_128_SHA": "C002",
            "TLS_ECDH_ECDSA_WITH_3DES_EDE_CBC_SHA": "C003",
            "TLS_ECDH_ECDSA_WITH_AES_128_CBC_SHA": "C004",
            "TLS_ECDH_ECDSA_WITH_AES_256_CBC_SHA": "C005",
            "TLS_ECDHE_ECDSA_WITH_NULL_SHA": "C006",
            "TLS_ECDHE_ECDSA_WITH_RC4_128_SHA": "C007",
            "TLS_ECDHE_ECDSA_WITH_3DES_EDE_CBC_SHA": "C008",
            "TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA": "C009",
            "TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA": "C00A",
            "TLS_ECDH_RSA_WITH_NULL_SHA": "C00B",
            "TLS_ECDH_RSA_WITH_RC4_128_SHA": "C00C",
            "TLS_ECDH_RSA_WITH_3DES_EDE_CBC_SHA": "C00D",
            "TLS_ECDH_RSA_WITH_AES_128_CBC_SHA": "C00E",
            "TLS_ECDH_RSA_WITH_AES_256_CBC_SHA": "C00F",
            "TLS_ECDHE_RSA_WITH_NULL_SHA": "C010",
            "TLS_ECDHE_RSA_WITH_RC4_128_SHA": "C011",
            "TLS_ECDHE_RSA_WITH_3DES_EDE_CBC_SHA": "C012",
            "TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA": "C013",
            "TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA": "C014",
            "TLS_ECDH_ANON_WITH_NULL_SHA": "C015",
            "TLS_ECDH_ANON_WITH_RC4_128_SHA": "C016",
            "TLS_ECDH_ANON_WITH_3DES_EDE_CBC_SHA": "C017",
            "TLS_ECDH_ANON_WITH_AES_128_CBC_SHA": "C018",
            "TLS_ECDH_ANON_WITH_AES_256_CBC_SHA": "C019",
            "TLS_SRP_SHA_WITH_3DES_EDE_CBC_SHA": "C01A",
            "TLS_SRP_SHA_RSA_WITH_3DES_EDE_CBC_SHA": "C01B",
            "TLS_SRP_SHA_DSS_WITH_3DES_EDE_CBC_SHA": "C01C",
            "TLS_SRP_SHA_WITH_AES_128_CBC_SHA": "C01D",
            "TLS_SRP_SHA_RSA_WITH_AES_128_CBC_SHA": "C01E",
            "TLS_SRP_SHA_DSS_WITH_AES_128_CBC_SHA": "C01F",
            "TLS_SRP_SHA_WITH_AES_256_CBC_SHA": "C020",
            "TLS_SRP_SHA_RSA_WITH_AES_256_CBC_SHA": "C021",
            "TLS_SRP_SHA_DSS_WITH_AES_256_CBC_SHA": "C022",
            "TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256": "C023",
            "TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384": "C024",
            "TLS_ECDH_ECDSA_WITH_AES_128_CBC_SHA256": "C025",
            "TLS_ECDH_ECDSA_WITH_AES_256_CBC_SHA384": "C026",
            "TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256": "C027",
            "TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384": "C028",
            "TLS_ECDH_RSA_WITH_AES_128_CBC_SHA256": "C029",
            "TLS_ECDH_RSA_WITH_AES_256_CBC_SHA384": "C02A",
            "TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256": "C02B",
            "TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384": "C02C",
            "TLS_ECDH_ECDSA_WITH_AES_128_GCM_SHA256": "C02D",
            "TLS_ECDH_ECDSA_WITH_AES_256_GCM_SHA384": "C02E",
            "TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256": "C02F",
            "TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384": "C030",
            "TLS_ECDH_RSA_WITH_AES_128_GCM_SHA256": "C031",
            "TLS_ECDH_RSA_WITH_AES_256_GCM_SHA384": "C032",
            "TLS_ECDHE_PSK_WITH_RC4_128_SHA": "C033",
            "TLS_ECDHE_PSK_WITH_3DES_EDE_CBC_SHA": "C034",
            "TLS_ECDHE_PSK_WITH_AES_128_CBC_SHA": "C035",
            "TLS_ECDHE_PSK_WITH_AES_256_CBC_SHA": "C036",
            "TLS_ECDHE_PSK_WITH_AES_128_CBC_SHA256": "C037",
            "TLS_ECDHE_PSK_WITH_AES_256_CBC_SHA384": "C038",
            "TLS_ECDHE_PSK_WITH_NULL_SHA": "C039",
            "TLS_ECDHE_PSK_WITH_NULL_SHA256": "C03A",
            "TLS_ECDHE_PSK_WITH_NULL_SHA384": "C03B",
            "TLS_RSA_WITH_ARIA_128_CBC_SHA256": "C03C",
            "TLS_RSA_WITH_ARIA_256_CBC_SHA384": "C03D",
            "TLS_DH_DSS_WITH_ARIA_128_CBC_SHA256": "C03E",
            "TLS_DH_DSS_WITH_ARIA_256_CBC_SHA384": "C03F",
            "TLS_DH_RSA_WITH_ARIA_128_CBC_SHA256": "C040",
            "TLS_DH_RSA_WITH_ARIA_256_CBC_SHA384": "C041",
            "TLS_DHE_DSS_WITH_ARIA_128_CBC_SHA256": "C042",
            "TLS_DHE_DSS_WITH_ARIA_256_CBC_SHA384": "C043",
            "TLS_DHE_RSA_WITH_ARIA_128_CBC_SHA256": "C044",
            "TLS_DHE_RSA_WITH_ARIA_256_CBC_SHA384": "C045",
            "TLS_DH_ANON_WITH_ARIA_128_CBC_SHA256": "C046",
            "TLS_DH_ANON_WITH_ARIA_256_CBC_SHA384": "C047",
            "TLS_ECDHE_ECDSA_WITH_ARIA_128_CBC_SHA256": "C048",
            "TLS_ECDHE_ECDSA_WITH_ARIA_256_CBC_SHA384": "C049",
            "TLS_ECDH_ECDSA_WITH_ARIA_128_CBC_SHA256": "C04A",
            "TLS_ECDH_ECDSA_WITH_ARIA_256_CBC_SHA384": "C04B",
            "TLS_ECDHE_RSA_WITH_ARIA_128_CBC_SHA256": "C04C",
            "TLS_ECDHE_RSA_WITH_ARIA_256_CBC_SHA384": "C04D",
            "TLS_ECDH_RSA_WITH_ARIA_128_CBC_SHA256": "C04E",
            "TLS_ECDH_RSA_WITH_ARIA_256_CBC_SHA384": "C04F",
            "TLS_RSA_WITH_ARIA_128_GCM_SHA256": "C050",
            "TLS_RSA_WITH_ARIA_256_GCM_SHA384": "C051",
            "TLS_DHE_RSA_WITH_ARIA_128_GCM_SHA256": "C052",
            "TLS_DHE_RSA_WITH_ARIA_256_GCM_SHA384": "C053",
            "TLS_DH_RSA_WITH_ARIA_128_GCM_SHA256": "C054",
            "TLS_DH_RSA_WITH_ARIA_256_GCM_SHA384": "C055",
            "TLS_DHE_DSS_WITH_ARIA_128_GCM_SHA256": "C056",
            "TLS_DHE_DSS_WITH_ARIA_256_GCM_SHA384": "C057",
            "TLS_DH_DSS_WITH_ARIA_128_GCM_SHA256": "C058",
            "TLS_DH_DSS_WITH_ARIA_256_GCM_SHA384": "C059",
            "TLS_DH_ANON_WITH_ARIA_128_GCM_SHA256": "C05A",
            "TLS_DH_ANON_WITH_ARIA_256_GCM_SHA384": "C05B",
            "TLS_ECDHE_ECDSA_WITH_ARIA_128_GCM_SHA256": "C05C",
            "TLS_ECDHE_ECDSA_WITH_ARIA_256_GCM_SHA384": "C05D",
            "TLS_ECDH_ECDSA_WITH_ARIA_128_GCM_SHA256": "C05E",
            "TLS_ECDH_ECDSA_WITH_ARIA_256_GCM_SHA384": "C05F",
            "TLS_ECDHE_RSA_WITH_ARIA_128_GCM_SHA256": "C060",
            "TLS_ECDHE_RSA_WITH_ARIA_256_GCM_SHA384": "C061",
            "TLS_ECDH_RSA_WITH_ARIA_128_GCM_SHA256": "C062",
            "TLS_ECDH_RSA_WITH_ARIA_256_GCM_SHA384": "C063",
            "TLS_PSK_WITH_ARIA_128_CBC_SHA256": "C064",
            "TLS_PSK_WITH_ARIA_256_CBC_SHA384": "C065",
            "TLS_DHE_PSK_WITH_ARIA_128_CBC_SHA256": "C066",
            "TLS_DHE_PSK_WITH_ARIA_256_CBC_SHA384": "C067",
            "TLS_RSA_PSK_WITH_ARIA_128_CBC_SHA256": "C068",
            "TLS_RSA_PSK_WITH_ARIA_256_CBC_SHA384": "C069",
            "TLS_PSK_WITH_ARIA_128_GCM_SHA256": "C06A",
            "TLS_PSK_WITH_ARIA_256_GCM_SHA384": "C06B",
            "TLS_DHE_PSK_WITH_ARIA_128_GCM_SHA256": "C06C",
            "TLS_DHE_PSK_WITH_ARIA_256_GCM_SHA384": "C06D",
            "TLS_RSA_PSK_WITH_ARIA_128_GCM_SHA256": "C06E",
            "TLS_RSA_PSK_WITH_ARIA_256_GCM_SHA384": "C06F",
            "TLS_ECDHE_PSK_WITH_ARIA_128_CBC_SHA256": "C070",
            "TLS_ECDHE_PSK_WITH_ARIA_256_CBC_SHA384": "C071",
            "TLS_ECDHE_ECDSA_WITH_CAMELLIA_128_CBC_SHA256": "C072",
            "TLS_ECDHE_ECDSA_WITH_CAMELLIA_256_CBC_SHA384": "C073",
            "TLS_ECDH_ECDSA_WITH_CAMELLIA_128_CBC_SHA256": "C074",
            "TLS_ECDH_ECDSA_WITH_CAMELLIA_256_CBC_SHA384": "C075",
            "TLS_ECDHE_RSA_WITH_CAMELLIA_128_CBC_SHA256": "C076",
            "TLS_ECDHE_RSA_WITH_CAMELLIA_256_CBC_SHA384": "C077",
            "TLS_ECDH_RSA_WITH_CAMELLIA_128_CBC_SHA256": "C078",
            "TLS_ECDH_RSA_WITH_CAMELLIA_256_CBC_SHA384": "C079",
            "TLS_RSA_WITH_CAMELLIA_128_GCM_SHA256": "C07A",
            "TLS_RSA_WITH_CAMELLIA_256_GCM_SHA384": "C07B",
            "TLS_DHE_RSA_WITH_CAMELLIA_128_GCM_SHA256": "C07C",
            "TLS_DHE_RSA_WITH_CAMELLIA_256_GCM_SHA384": "C07D",
            "TLS_DH_RSA_WITH_CAMELLIA_128_GCM_SHA256": "C07E",
            "TLS_DH_RSA_WITH_CAMELLIA_256_GCM_SHA384": "C07F",
            "TLS_DHE_DSS_WITH_CAMELLIA_128_GCM_SHA256": "C080",
            "TLS_DHE_DSS_WITH_CAMELLIA_256_GCM_SHA384": "C081",
            "TLS_DH_DSS_WITH_CAMELLIA_128_GCM_SHA256": "C082",
            "TLS_DH_DSS_WITH_CAMELLIA_256_GCM_SHA384": "C083",
            "TLS_DH_ANON_WITH_CAMELLIA_128_GCM_SHA256": "C084",
            "TLS_DH_ANON_WITH_CAMELLIA_256_GCM_SHA384": "C085",
            "TLS_ECDHE_ECDSA_WITH_CAMELLIA_128_GCM_SHA256": "C086",
            "TLS_ECDHE_ECDSA_WITH_CAMELLIA_256_GCM_SHA384": "C087",
            "TLS_ECDH_ECDSA_WITH_CAMELLIA_128_GCM_SHA256": "C088",
            "TLS_ECDH_ECDSA_WITH_CAMELLIA_256_GCM_SHA384": "C089",
            "TLS_ECDHE_RSA_WITH_CAMELLIA_128_GCM_SHA256": "C08A",
            "TLS_ECDHE_RSA_WITH_CAMELLIA_256_GCM_SHA384": "C08B",
            "TLS_ECDH_RSA_WITH_CAMELLIA_128_GCM_SHA256": "C08C",
            "TLS_ECDH_RSA_WITH_CAMELLIA_256_GCM_SHA384": "C08D",
            "TLS_PSK_WITH_CAMELLIA_128_GCM_SHA256": "C08E",
            "TLS_PSK_WITH_CAMELLIA_256_GCM_SHA384": "C08F",
            "TLS_DHE_PSK_WITH_CAMELLIA_128_GCM_SHA256": "C090",
            "TLS_DHE_PSK_WITH_CAMELLIA_256_GCM_SHA384": "C091",
            "TLS_RSA_PSK_WITH_CAMELLIA_128_GCM_SHA256": "C092",
            "TLS_RSA_PSK_WITH_CAMELLIA_256_GCM_SHA384": "C093",
            "TLS_PSK_WITH_CAMELLIA_128_CBC_SHA256": "C094",
            "TLS_PSK_WITH_CAMELLIA_256_CBC_SHA384": "C095",
            "TLS_DHE_PSK_WITH_CAMELLIA_128_CBC_SHA256": "C096",
            "TLS_DHE_PSK_WITH_CAMELLIA_256_CBC_SHA384": "C097",
            "TLS_RSA_PSK_WITH_CAMELLIA_128_CBC_SHA256": "C098",
            "TLS_RSA_PSK_WITH_CAMELLIA_256_CBC_SHA384": "C099",
            "TLS_ECDHE_PSK_WITH_CAMELLIA_128_CBC_SHA256": "C09A",
            "TLS_ECDHE_PSK_WITH_CAMELLIA_256_CBC_SHA384": "C09B",
            "TLS_RSA_WITH_AES_128_CCM": "C09C",
            "TLS_RSA_WITH_AES_256_CCM": "C09D",
            "TLS_DHE_RSA_WITH_AES_128_CCM": "C09E",
            "TLS_DHE_RSA_WITH_AES_256_CCM": "C09F",
            "TLS_RSA_WITH_AES_128_CCM_8": "C0A0",
            "TLS_RSA_WITH_AES_256_CCM_8": "C0A1",
            "TLS_DHE_RSA_WITH_AES_128_CCM_8": "C0A2",
            "TLS_DHE_RSA_WITH_AES_256_CCM_8": "C0A3",
            "TLS_PSK_WITH_AES_128_CCM": "C0A4",
            "TLS_PSK_WITH_AES_256_CCM": "C0A5",
            "TLS_DHE_PSK_WITH_AES_128_CCM": "C0A6",
            "TLS_DHE_PSK_WITH_AES_256_CCM": "C0A7",
            "TLS_PSK_WITH_AES_128_CCM_8": "C0A8",
            "TLS_PSK_WITH_AES_256_CCM_8": "C0A9",
            "TLS_PSK_DHE_WITH_AES_128_CCM_8": "C0AA",
            "TLS_PSK_DHE_WITH_AES_256_CCM_8": "C0AB",
            "TLS_ECDHE_ECDSA_WITH_AES_128_CCM": "C0AC",
            "TLS_ECDHE_ECDSA_WITH_AES_256_CCM": "C0AD",
            "TLS_ECDHE_ECDSA_WITH_AES_128_CCM_8": "C0AE",
            "TLS_ECDHE_ECDSA_WITH_AES_256_CCM_8": "C0AF",
            "TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256_OLD": "CC13",
            "TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256_OLD": "CC14",
            "TLS_DHE_RSA_WITH_CHACHA20_POLY1305_SHA256_OLD": "CC15",
            "TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256": "CCA8",
            "TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256": "CCA9",
            "TLS_DHE_RSA_WITH_CHACHA20_POLY1305_SHA256": "CCAA",
            "TLS_PSK_WITH_CHACHA20_POLY1305_SHA256": "CCAB",
            "TLS_ECDHE_PSK_WITH_CHACHA20_POLY1305_SHA256": "CCAC",
            "TLS_DHE_PSK_WITH_CHACHA20_POLY1305_SHA256": "CCAD",
            "TLS_RSA_PSK_WITH_CHACHA20_POLY1305_SHA256": "CCAE",
            "SSL_RSA_FIPS_WITH_DES_CBC_SHA": "FEFE",
            "SSL_RSA_FIPS_WITH_3DES_EDE_CBC_SHA": "FEFF",
            "SSL_RSA_FIPS_WITH_DES_CBC_SHA_2": "FFE1",
            "SSL_RSA_FIPS_WITH_3DES_EDE_CBC_SHA_2": "FFE0",
            "SSL_RSA_WITH_RC2_CBC_MD5": "FF80",
            "SSL_RSA_WITH_IDEA_CBC_MD5": "FF81",
            "SSL_RSA_WITH_DES_CBC_MD5": "FF82",
            "SSL_RSA_WITH_3DES_EDE_CBC_MD5": "FF83",
            "TLS_EMPTY_RENEGOTIATION_INFO_SCSV": "00FF",
        }

        self.srlt = ""
        self.scs = self.tls_cipher2byte(info.get("cipher", ""))
        self.cs = self.tls_ciphers2bytes(info.get("client_ciphers", ""))
        # self.tls_isid = info.get("session_id", "")            # not in correlation result and not used in predict
        # self.tls_osid = info.get("client_session_id", "")     # not in correlation result and not used in predict
        self.s_version = self.tls_version2code(info.get("version", ""))
        self.c_version = self.tls_version2code(info.get("client_version", ""))
        # ###from joy
        # 176



    def tls_version2code(self, version):
        """convert tls version to code"""
        return self.version_code_map.get(version, 0)

    def tls_cipher2byte(self, cipher):
        """ Convert TLS cipher to byte-16bit """
        try:
            byte = self.cipher_bytes_map.get(cipher)
        except:
            byte = None
        if byte is None:
            print("tls cipher of '%s' is not in the cipher_bytes_map." % cipher)
            byte = ""
        return byte

    def tls_ciphers2bytes(self, ciphers):
        """ Convert TLS ciphers to bytes-16bit """
        bytes = list()
        for cipher in ciphers.split(","):
            byte = self.tls_cipher2byte(cipher)
            if byte != "" and byte in cs:
                bytes.append(byte)
        return bytes




